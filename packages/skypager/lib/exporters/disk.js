'use strict';

module.exports = function run_disk_exporter() {
  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

  var fs = require('fs'),
      path = require('path'),
      exists = fs.existsSync,
      mkdir = fs.mkdirSync,
      writeFile = fs.writeFileSync,
      readFile = fs.readFileSync;

  var project = options.project = options.project || this,
      type = options.type || 'snapshot',
      filename = options.filename || type,
      format = options.format || 'js',
      path = options.path || project.path('build', filename + '.' + format),
      payload = options.payload ? options.payload : project.run.exporter(type, options),
      serialized = '';

  if (format === 'json' || format === 'js') {
    serialized = JSON.stringify(payload);

    if (format === 'js') {
      serialized = 'module.exports = JSON.parse(' + serialized + ')';
    }
  }

  if (serialized.length > 0) {
    writeFile(path, serialized);
  }

  return path;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9leHBvcnRlcnMvZGlzay5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU0sQ0FBQyxPQUFPLEdBQUcsU0FBUyxpQkFBaUIsR0FBZ0I7TUFBZCxPQUFPLHlEQUFHLEVBQUU7O0FBQ3ZELE1BQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7TUFDbEIsSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7TUFDdEIsTUFBTSxHQUFHLEVBQUUsQ0FBQyxVQUFVO01BQ3RCLEtBQUssR0FBRyxFQUFFLENBQUMsU0FBUztNQUNwQixTQUFTLEdBQUcsRUFBRSxDQUFDLGFBQWE7TUFDNUIsUUFBUSxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUE7O0FBRTlCLE1BQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sSUFBSSxJQUFJO01BQ25ELElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxJQUFJLFVBQVU7TUFDakMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxRQUFRLElBQUksSUFBSTtNQUNuQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sSUFBSSxJQUFJO01BQy9CLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsR0FBRyxHQUFHLEdBQUcsTUFBTSxDQUFDO01BQ3JFLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQztNQUNqRixVQUFVLEdBQUcsRUFBRSxDQUFDOztBQUVoQixNQUFJLE1BQU0sS0FBSyxNQUFNLElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtBQUN4QyxjQUFVLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQTs7QUFFcEMsUUFBSSxNQUFNLEtBQUssSUFBSSxFQUFFO0FBQ25CLGdCQUFVLEdBQUcsOEJBQThCLEdBQUcsVUFBVSxHQUFHLEdBQUcsQ0FBQTtLQUMvRDtHQUNGOztBQUVELE1BQUksVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7QUFDekIsYUFBUyxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsQ0FBQTtHQUM1Qjs7QUFFTCxTQUFPLElBQUksQ0FBQTtDQUNaLENBQUEiLCJmaWxlIjoiZGlzay5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcnVuX2Rpc2tfZXhwb3J0ZXIgKG9wdGlvbnMgPSB7fSkge1xuICB2YXIgZnMgPSByZXF1aXJlKCdmcycpLFxuICAgICAgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKSxcbiAgICAgIGV4aXN0cyA9IGZzLmV4aXN0c1N5bmMsXG4gICAgICBta2RpciA9IGZzLm1rZGlyU3luYyxcbiAgICAgIHdyaXRlRmlsZSA9IGZzLndyaXRlRmlsZVN5bmMsXG4gICAgICByZWFkRmlsZSA9IGZzLnJlYWRGaWxlU3luY1xuXG4gIHZhciBwcm9qZWN0ID0gb3B0aW9ucy5wcm9qZWN0ID0gb3B0aW9ucy5wcm9qZWN0IHx8IHRoaXMsXG4gICAgICB0eXBlID0gb3B0aW9ucy50eXBlIHx8ICdzbmFwc2hvdCcsXG4gICAgICBmaWxlbmFtZSA9IG9wdGlvbnMuZmlsZW5hbWUgfHwgdHlwZSxcbiAgICAgIGZvcm1hdCA9IG9wdGlvbnMuZm9ybWF0IHx8ICdqcycsXG4gICAgICBwYXRoID0gb3B0aW9ucy5wYXRoIHx8IHByb2plY3QucGF0aCgnYnVpbGQnLCBmaWxlbmFtZSArICcuJyArIGZvcm1hdCksXG4gICAgICBwYXlsb2FkID0gb3B0aW9ucy5wYXlsb2FkID8gb3B0aW9ucy5wYXlsb2FkIDogcHJvamVjdC5ydW4uZXhwb3J0ZXIodHlwZSwgb3B0aW9ucyksXG4gICAgICBzZXJpYWxpemVkID0gJyc7XG5cbiAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJyB8fCBmb3JtYXQgPT09ICdqcycpIHtcbiAgICAgICAgc2VyaWFsaXplZCA9IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpXG5cbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzJykge1xuICAgICAgICAgIHNlcmlhbGl6ZWQgPSAnbW9kdWxlLmV4cG9ydHMgPSBKU09OLnBhcnNlKCcgKyBzZXJpYWxpemVkICsgJyknXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKHNlcmlhbGl6ZWQubGVuZ3RoID4gMCkge1xuICAgICAgICB3cml0ZUZpbGUocGF0aCwgc2VyaWFsaXplZClcbiAgICAgIH1cblxuICByZXR1cm4gcGF0aFxufVxuXG5cbiJdfQ==