'use strict';

module.exports = function run_disk_exporter() {
  var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];

  var fs = require('fs'),
      path = require('path'),
      exists = fs.existsSync,
      mkdir = fs.mkdirSync,
      writeFile = fs.writeFileSync,
      readFile = fs.readFileSync;

  var project = options.project = options.project || this,
      type = options.type || 'snapshot',
      filename = options.filename || type,
      format = options.format || 'json',
      path = options.path || project.path('build', filename + '.' + format),
      payload = options.payload ? options.payload : project.run.exporter(type, options),
      serialized = '';

  if (format === 'json' || format === 'js') {
    serialized = JSON.stringify(payload);

    if (format === 'js') {
      serialized = 'module.exports = JSON.parse(' + JSON.stringify(payload) + ')';
    }
  }

  if (serialized.length > 0) {
    writeFile(path, serialized);
  }

  return path;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9leHBvcnRlcnMvZGlzay5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLE1BQU0sQ0FBQyxPQUFPLEdBQUcsU0FBUyxpQkFBaUIsR0FBZ0I7TUFBZCxPQUFPLHlEQUFHLEVBQUU7O0FBQ3ZELE1BQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7TUFDbEIsSUFBSSxHQUFHLE9BQU8sQ0FBQyxNQUFNLENBQUM7TUFDdEIsTUFBTSxHQUFHLEVBQUUsQ0FBQyxVQUFVO01BQ3RCLEtBQUssR0FBRyxFQUFFLENBQUMsU0FBUztNQUNwQixTQUFTLEdBQUcsRUFBRSxDQUFDLGFBQWE7TUFDNUIsUUFBUSxHQUFHLEVBQUUsQ0FBQyxZQUFZLENBQUE7O0FBRTlCLE1BQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sSUFBSSxJQUFJO01BQ25ELElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxJQUFJLFVBQVU7TUFDakMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxRQUFRLElBQUksSUFBSTtNQUNuQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sSUFBSSxNQUFNO01BQ2pDLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsR0FBRyxHQUFHLEdBQUcsTUFBTSxDQUFDO01BQ3JFLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQztNQUNqRixVQUFVLEdBQUcsRUFBRSxDQUFDOztBQUVoQixNQUFJLE1BQU0sS0FBSyxNQUFNLElBQUksTUFBTSxLQUFLLElBQUksRUFBRTtBQUN4QyxjQUFVLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQTs7QUFFcEMsUUFBSSxNQUFNLEtBQUssSUFBSSxFQUFFO0FBQ25CLGdCQUFVLG9DQUFtQyxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxNQUFJLENBQUE7S0FDekU7R0FDRjs7QUFFRCxNQUFJLFVBQVUsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO0FBQ3pCLGFBQVMsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLENBQUE7R0FDNUI7O0FBRUwsU0FBTyxJQUFJLENBQUE7Q0FDWixDQUFBIiwiZmlsZSI6ImRpc2suanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHJ1bl9kaXNrX2V4cG9ydGVyIChvcHRpb25zID0ge30pIHtcbiAgdmFyIGZzID0gcmVxdWlyZSgnZnMnKSxcbiAgICAgIHBhdGggPSByZXF1aXJlKCdwYXRoJyksXG4gICAgICBleGlzdHMgPSBmcy5leGlzdHNTeW5jLFxuICAgICAgbWtkaXIgPSBmcy5ta2RpclN5bmMsXG4gICAgICB3cml0ZUZpbGUgPSBmcy53cml0ZUZpbGVTeW5jLFxuICAgICAgcmVhZEZpbGUgPSBmcy5yZWFkRmlsZVN5bmNcblxuICB2YXIgcHJvamVjdCA9IG9wdGlvbnMucHJvamVjdCA9IG9wdGlvbnMucHJvamVjdCB8fCB0aGlzLFxuICAgICAgdHlwZSA9IG9wdGlvbnMudHlwZSB8fCAnc25hcHNob3QnLFxuICAgICAgZmlsZW5hbWUgPSBvcHRpb25zLmZpbGVuYW1lIHx8IHR5cGUsXG4gICAgICBmb3JtYXQgPSBvcHRpb25zLmZvcm1hdCB8fCAnanNvbicsXG4gICAgICBwYXRoID0gb3B0aW9ucy5wYXRoIHx8IHByb2plY3QucGF0aCgnYnVpbGQnLCBmaWxlbmFtZSArICcuJyArIGZvcm1hdCksXG4gICAgICBwYXlsb2FkID0gb3B0aW9ucy5wYXlsb2FkID8gb3B0aW9ucy5wYXlsb2FkIDogcHJvamVjdC5ydW4uZXhwb3J0ZXIodHlwZSwgb3B0aW9ucyksXG4gICAgICBzZXJpYWxpemVkID0gJyc7XG5cbiAgICAgIGlmIChmb3JtYXQgPT09ICdqc29uJyB8fCBmb3JtYXQgPT09ICdqcycpIHtcbiAgICAgICAgc2VyaWFsaXplZCA9IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpXG5cbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gJ2pzJykge1xuICAgICAgICAgIHNlcmlhbGl6ZWQgPSBgbW9kdWxlLmV4cG9ydHMgPSBKU09OLnBhcnNlKCR7IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpIH0pYFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChzZXJpYWxpemVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgd3JpdGVGaWxlKHBhdGgsIHNlcmlhbGl6ZWQpXG4gICAgICB9XG5cbiAgcmV0dXJuIHBhdGhcbn1cblxuXG4iXX0=